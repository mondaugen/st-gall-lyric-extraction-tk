import sys
import matplotlib.pyplot as plt
from numpy import NaN, Inf, arange, isscalar, array, argmax
 
def peakdet(v, delta, minimum_y_threshold = 500, minimum_x_threshold = 50, x = None):
    """
    Converted from MATLAB script at http://billauer.co.il/peakdet.html
    
    Returns two arrays
    
    function [maxtab, mintab]=peakdet(v, delta, x)
    %        [MAXTAB, MINTAB] = PEAKDET(V, DELTA) finds the local
    %        maxima and minima ("peaks") in the vector V.
    %        MAXTAB and MINTAB consists of two columns. Column 1
    %        contains indices in V, and column 2 the found values.
    %      
    %        With [MAXTAB, MINTAB] = PEAKDET(V, DELTA, X) the indices
    %        in MAXTAB and MINTAB are replaced with the corresponding
    %        X-values.
    %
    %        A point is considered a maximum peak if it has the maximal
    %        value, and was preceded (to the left) by a value lower by
    %        DELTA.
    %        MINIMUM_Y_THRESHOLD is the threshold for minimum maximum
    %           values
    %        MINIMUM_X_THRESHOLD: minimum horizontal difference between 2
    %           maximum candidates
    """

    maxtab = []
    mintab = []
       
    if x is None:
        x = arange(len(v))
    
    v = array(v)
    
    if len(v) != len(x):
        sys.exit('Input vectors v and x must have same length')
    
    if not isscalar(delta):
        sys.exit('Input argument delta must be a scalar')
    
    if delta <= 0:
        sys.exit('Input argument delta must be positive')
    
    mn, mx = Inf, -Inf
    mnpos, mxpos = NaN, NaN
    
    lookformax = True
    
    for i in arange(len(v)):
        this = v[i]
        if this > mx:
            mx = this
            mxpos = x[i]
        if this < mn:
            mn = this
            mnpos = x[i]
        
        if lookformax:
            if this < mx-delta and this >= minimum_y_threshold:
        
                maxtab.append((mxpos, mx))
                mn = this
                mnpos = x[i]
                lookformax = False
        else:
            if this > mn+delta:
                mintab.append((mnpos, mn))
                mx = this
                mxpos = x[i]
                lookformax = True
 
    # check for close max candidates, choose only one
    for i in range(len(maxtab)-1, 0, -1):
        if maxtab[i][0]-maxtab[i-1][0] < minimum_x_threshold: # minimum x threshold
            if maxtab[i][1] >= maxtab[i-1][1]:
                del maxtab[i-1]
            else:
                del maxtab[i]

    return array(maxtab), array(mintab)
 
if __name__=="__main__":
    series = [7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 5, 3, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 5, 4, 4, 5, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 9, 9, 11, 11, 10, 9, 10, 10, 9, 9, 9, 9, 7, 8, 14, 13, 12, 15, 14, 16, 14, 15, 17, 21, 20, 21, 20, 21, 22, 19, 20, 17, 15, 17, 13, 15, 13, 24, 25, 13, 16, 24, 29, 23, 38, 37, 15, 17, 17, 19, 22, 24, 34, 44, 49, 62, 66, 82, 76, 80, 92, 105, 89, 108, 102, 84, 71, 80, 79, 70, 72, 70, 67, 70, 62, 61, 59, 59, 59, 56, 56, 58, 56, 56, 61, 61, 61, 60, 61, 59, 57, 55, 48, 44, 44, 43, 40, 43, 43, 42, 42, 42, 39, 40, 40, 40, 40, 38, 36, 34, 32, 30, 26, 27, 24, 23, 23, 23, 19, 20, 17, 16, 12, 15, 14, 13, 23, 24, 14, 17, 23, 37, 45, 35, 29, 26, 31, 31, 21, 19, 17, 15, 15, 14, 17, 18, 14, 14, 17, 17, 15, 15, 18, 24, 25, 28, 33, 34, 46, 46, 39, 32, 20, 13, 13, 13, 9, 10, 12, 12, 12, 12, 12, 11, 9, 9, 12, 12, 12, 13, 13, 13, 13, 13, 11, 9, 8, 8, 8, 8, 8, 8, 7, 7, 6, 6, 6, 7, 6, 8, 6, 6, 7, 9, 12, 11, 9, 6, 6, 6, 9, 9, 8, 8, 7, 7, 7, 9, 7, 6, 7, 8, 9, 8, 8, 10, 13, 11, 11, 11, 10, 9, 9, 9, 9, 9, 9, 9, 8, 7, 9, 10, 9, 10, 10, 8, 7, 6, 5, 6, 4, 4, 6, 12, 15, 15, 16, 15, 12, 11, 7, 9, 10, 6, 6, 4, 3, 3, 3, 2, 2, 2, 3, 10, 15, 20, 25, 28, 28, 29, 26, 26, 24, 25, 26, 27, 27, 27, 23, 19, 22, 24, 41, 44, 42, 42, 44, 57, 69, 78, 76, 83, 87, 96, 99, 101, 120, 129, 137, 147, 159, 162, 158, 155, 156, 163, 176, 198, 220, 237, 255, 270, 282, 290, 306, 316, 307, 287, 290, 287, 289, 283, 271, 264, 269, 274, 268, 265, 257, 250, 241, 223, 218, 228, 216, 209, 186, 180, 190, 183, 190, 182, 178, 157, 132, 139, 134, 132, 132, 133, 146, 146, 144, 138, 126, 111, 122, 138, 152, 158, 156, 163, 166, 182, 198, 206, 207, 218, 228, 232, 238, 266, 336, 436, 555, 673, 796, 911, 994, 1055, 1120, 1133, 1107, 1022, 955, 889, 831, 808, 784, 751, 754, 771, 819, 900, 969, 1028, 1032, 998, 977, 913, 806, 667, 539, 438, 339, 286, 224, 176, 153, 142, 138, 136, 149, 154, 161, 178, 206, 201, 195, 183, 185, 175, 173, 175, 160, 155, 145, 149, 169, 183, 190, 187, 219, 224, 248, 272, 278, 298, 314, 338, 353, 380, 392, 434, 462, 482, 481, 466, 455, 462, 469, 460, 457, 448, 444, 452, 419, 404, 413, 408, 394, 361, 348, 330, 326, 316, 293, 278, 268, 254, 248, 212, 185, 163, 142, 127, 108, 82, 74, 65, 53, 49, 50, 44, 33, 34, 34, 35, 35, 35, 40, 41, 49, 56, 61, 76, 77, 83, 93, 123, 173, 240, 335, 441, 601, 743, 879, 978, 1070, 1124, 1097, 1049, 981, 948, 875, 806, 778, 779, 775, 807, 867, 940, 1013, 1058, 1084, 1093, 1082, 1026, 921, 831, 688, 534, 414, 325, 255, 214, 162, 127, 118, 107, 103, 96, 89, 83, 76, 76, 78, 76, 87, 117, 126, 131, 136, 135, 139, 152, 162, 173, 198, 215, 233, 251, 269, 296, 300, 311, 321, 323, 324, 337, 358, 381, 392, 388, 374, 365, 347, 335, 342, 318, 327, 334, 334, 342, 326, 325, 332, 317, 298, 279, 271, 261, 236, 212, 194, 189, 191, 178, 169, 160, 149, 141, 134, 130, 120, 119, 120, 131, 139, 151, 159, 176, 192, 224, 259, 310, 387, 479, 591, 726, 824, 911, 959, 987, 991, 974, 966, 918, 890, 836, 809, 793, 839, 871, 905, 940, 953, 972, 972, 964, 938, 904, 871, 796, 699, 650, 585, 510, 425, 338, 269, 251, 213, 192, 163, 150, 130, 116, 104, 97, 97, 90, 82, 79, 76, 100, 118, 141, 157, 162, 174, 180, 168, 167, 178, 187, 207, 228, 247, 272, 292, 288, 328, 345, 357, 363, 364, 354, 359, 353, 362, 390, 404, 406, 410, 430, 413, 379, 360, 341, 309, 284, 258, 250, 252, 239, 231, 231, 215, 207, 190, 185, 163, 137, 121, 106, 106, 108, 116, 127, 138, 143, 154, 161, 188, 236, 279, 348, 402, 452, 499, 555, 595, 590, 605, 622, 657, 675, 708, 727, 757, 804, 828, 881, 961, 1038, 1124, 1159, 1212, 1220, 1204, 1158, 1095, 1046, 952, 880, 820, 794, 784, 780, 781, 788, 759, 756, 752, 740, 745, 684, 588, 504, 428, 353, 260, 219, 174, 169, 177, 187, 198, 203, 213, 206, 201, 191, 182, 193, 212, 202, 199, 196, 212, 230, 267, 294, 319, 331, 333, 345, 349, 364, 370, 377, 393, 405, 414, 409, 403, 400, 375, 351, 344, 338, 345, 327, 313, 303, 269, 256, 222, 215, 197, 191, 191, 185, 185, 179, 174, 182, 177, 158, 158, 149, 165, 226, 277, 331, 374, 428, 485, 523, 577, 649, 690, 724, 757, 772, 775, 778, 798, 829, 801, 778, 765, 772, 828, 911, 1010, 1061, 1057, 1072, 1043, 1020, 996, 912, 802, 731, 659, 595, 535, 498, 451, 406, 381, 382, 418, 442, 463, 444, 410, 372, 338, 281, 208, 150, 129, 89, 84, 81, 79, 89, 100, 107, 103, 97, 101, 108, 110, 121, 118, 115, 109, 114, 108, 105, 90, 94, 107, 111, 111, 111, 114, 123, 118, 113, 93, 96, 92, 85, 88, 93, 99, 104, 100, 94, 89, 89, 86, 88, 105, 114, 127, 140, 150, 179, 194, 213, 236, 257, 269, 281, 288, 287, 272, 295, 318, 332, 349, 394, 421, 434, 445, 480, 510, 544, 594, 622, 663, 712, 763, 797, 832, 829, 827, 835, 845, 851, 861, 889, 922, 932, 920, 930, 890, 862, 815, 748, 666, 626, 607, 572, 515, 477, 425, 423, 412, 407, 394, 387, 371, 352, 335, 296, 274, 225, 185, 202, 185, 163, 162, 166, 163, 143, 136, 128, 140, 158, 180, 200, 229, 258, 283, 311, 303, 314, 296, 282, 267, 248, 228, 216, 216, 220, 239, 258, 276, 280, 299, 312, 313, 312, 306, 284, 267, 263, 270, 261, 250, 261, 258, 248, 229, 206, 191, 166, 142, 139, 142, 135, 134, 132, 140, 169, 186, 197, 215, 224, 239, 261, 266, 275, 268, 268, 285, 323, 382, 441, 504, 615, 715, 795, 867, 931, 954, 951, 923, 877, 911, 933, 956, 987, 983, 1020, 1061, 1119, 1132, 1147, 1145, 1153, 1149, 1088, 1055, 965, 884, 757, 663, 607, 587, 592, 575, 557, 529, 517, 495, 447, 370, 308, 231, 176, 131, 108, 101, 87, 72, 86, 95, 104, 104, 105, 108, 115, 132, 166, 185, 190, 202, 211, 224, 236, 233, 231, 236, 252, 250, 238, 236, 245, 250, 272, 279, 285, 285, 288, 285, 284, 293, 273, 288, 300, 309, 326, 309, 295, 284, 259, 213, 179, 156, 134, 137, 147, 149, 141, 140, 144, 148, 157, 180, 199, 232, 237, 257, 266, 280, 282, 285, 273, 279, 331, 415, 541, 659, 755, 826, 893, 986, 1092, 1116, 1083, 1026, 1015, 1031, 1049, 1027, 991, 961, 993, 1032, 1058, 1133, 1187, 1204, 1162, 1075, 1014, 909, 840, 764, 727, 658, 598, 545, 485, 430, 367, 328, 304, 302, 289, 287, 277, 254, 222, 201, 186, 157, 133, 120, 102, 93, 85, 100, 108, 148, 154, 155, 161, 154, 161, 164, 157, 163, 177, 187, 202, 215, 227, 243, 261, 271, 279, 273, 259, 263, 268, 277, 270, 271, 280, 279, 326, 335, 332, 342, 363, 364, 396, 415, 424, 439, 451, 468, 445, 437, 411, 377, 338, 302, 276, 252, 240, 239, 201, 175, 174, 150, 129, 124, 126, 121, 111, 130, 129, 145, 190, 205, 239, 258, 258, 272, 284, 303, 315, 295, 289, 294, 309, 332, 375, 441, 492, 558, 657, 738, 813, 869, 907, 936, 938, 918, 918, 927, 907, 877, 876, 870, 864, 871, 880, 922, 973, 1016, 1040, 1057, 1059, 1051, 983, 887, 814, 694, 622, 558, 455, 405, 388, 326, 261, 195, 161, 117, 102, 87, 95, 84, 96, 101, 115, 135, 141, 146, 164, 184, 183, 182, 186, 192, 210, 198, 222, 256, 285, 305, 300, 323, 341, 350, 370, 360, 383, 378, 384, 376, 406, 445, 450, 475, 462, 465, 458, 441, 412, 395, 399, 394, 383, 392, 417, 419, 381, 368, 353, 348, 318, 289, 246, 207, 186, 182, 169, 143, 113, 102, 92, 90, 102, 98, 105, 95, 98, 111, 112, 127, 129, 145, 158, 164, 182, 221, 244, 280, 326, 386, 500, 610, 725, 862, 923, 970, 999, 1025, 1028, 981, 943, 910, 875, 857, 827, 817, 816, 842, 843, 869, 930, 980, 1002, 1011, 1014, 940, 841, 741, 642, 561, 463, 382, 292, 247, 204, 144, 93, 42, 34, 24, 23, 18, 16, 26, 37, 50, 71, 81, 96, 110, 108, 109, 121, 120, 135, 146, 174, 184, 198, 210, 258, 270, 273, 286, 281, 286, 293, 302, 303, 303, 296, 290, 312, 351, 386, 408, 395, 391, 368, 340, 320, 296, 292, 265, 250, 232, 229, 200, 206, 203, 196, 179, 178, 160, 171, 180, 195, 205, 222, 238, 256, 263, 267, 263, 273, 264, 266, 296, 331, 384, 437, 487, 554, 637, 701, 768, 805, 827, 855, 873, 891, 877, 842, 836, 862, 876, 930, 949, 982, 1008, 1023, 1027, 1005, 958, 876, 836, 770, 711, 711, 697, 687, 642, 551, 485, 453, 441, 414, 327, 263, 219, 199, 186, 192, 187, 188, 199, 202, 215, 205, 181, 163, 133, 128, 130, 127, 130, 154, 154, 155, 157, 163, 165, 154, 129, 136, 146, 171, 200, 229, 254, 278, 293, 296, 292, 262, 274, 278, 266, 262, 256, 244, 246, 240, 212, 202, 209, 212, 196, 197, 198, 204, 210, 217, 223, 219, 223, 226, 242, 265, 290, 309, 334, 351, 365, 382, 419, 434, 469, 507, 549, 573, 604, 643, 679, 712, 751, 744, 740, 752, 765, 812, 839, 870, 903, 884, 877, 857, 861, 840, 769, 696, 635, 600, 526, 455, 382, 315, 293, 234, 206, 187, 182, 146, 113, 118, 116, 125, 121, 115, 113, 126, 129, 139, 139, 138, 151, 158, 162, 179, 186, 184, 188, 213, 184, 191, 194, 207, 211, 220, 229, 237, 254, 280, 301, 325, 360, 369, 369, 360, 363, 350, 329, 332, 347, 348, 347, 344, 335, 344, 319, 313, 315, 335, 354, 354, 368, 373, 355, 391, 377, 341, 332, 333, 325, 298, 278, 230, 220, 184, 168, 130, 111, 101, 88, 84, 94, 84, 91, 103, 108, 110, 104, 103, 99, 91, 92, 94, 100, 115, 120, 126, 128, 139, 148, 180, 179, 194, 209, 258, 318, 342, 375, 423, 494, 547, 585, 603, 592, 582, 615, 664, 670, 680, 732, 772, 783, 778, 771, 784, 785, 790, 767, 751, 761, 773, 749, 721, 679, 623, 581, 565, 512, 480, 451, 427, 365, 333, 267, 229, 171, 131, 101, 103, 87, 69, 63, 71, 80, 99, 120, 125, 141, 160, 179, 208, 228, 235, 269, 308, 335, 356, 378, 408, 435, 433, 414, 416, 422, 426, 440, 431, 418, 425, 441, 430, 448, 452, 442, 420, 375, 357, 374, 378, 360, 355, 354, 347, 344, 327, 322, 308, 281, 271, 251, 204, 158, 142, 104, 80, 64, 59, 64, 82, 95, 108, 115, 112, 116, 121, 116, 113, 103, 108, 105, 105, 103, 103, 115, 146, 199, 236, 270, 338, 390, 412, 435, 452, 448, 411, 395, 374, 348, 328, 315, 328, 324, 341, 361, 375, 411, 420, 426, 417, 412, 379, 337, 292, 248, 213, 169, 143, 129, 128, 103, 107, 121, 128, 155, 176, 187, 195, 208, 223, 242, 245, 239, 219, 221, 222, 233, 225, 228, 239, 250, 264, 278, 298, 307, 312, 325, 325, 319, 308, 307, 305, 314, 333, 350, 371, 387, 384, 382, 392, 387, 379, 350, 320, 288, 262, 219, 186, 139, 115, 104, 90, 81, 65, 66, 72, 64, 63, 87, 112, 131, 154, 173, 184, 193, 203, 208, 215, 208, 215, 220, 230, 236, 263, 298, 330, 379, 459, 566, 714, 811, 880, 951, 1000, 1031, 1065, 1065, 1030, 970, 897, 876, 857, 830, 846, 851, 867, 917, 935, 979, 1024, 1043, 1018, 946, 903, 848, 781, 694, 587, 487, 397, 319, 252, 200, 163, 138, 131, 117, 116, 122, 122, 130, 159, 178, 196, 202, 206, 208, 204, 168, 152, 143, 155, 158, 147, 138, 135, 145, 136, 130, 137, 137, 140, 154, 165, 167, 178, 192, 211, 226, 237, 241, 265, 265, 273, 275, 316, 319, 340, 352, 336, 287, 270, 224, 210, 170, 158, 162, 167, 172, 180, 175, 185, 200, 199, 203, 214, 228, 229, 232, 232, 229, 225, 230, 237, 256, 274, 302, 364, 426, 500, 548, 599, 638, 696, 745, 782, 785, 791, 835, 917, 1002, 1063, 1088, 1129, 1139, 1153, 1183, 1150, 1150, 1131, 1116, 1093, 1060, 1021, 960, 902, 841, 781, 727, 742, 755, 783, 795, 770, 710, 649, 562, 492, 399, 308, 221, 177, 142, 133, 110, 86, 88, 86, 90, 94, 92, 88, 88, 95, 98, 97, 114, 120, 123, 131, 138, 161, 163, 164, 159, 158, 165, 180, 198, 210, 210, 215, 216, 225, 224, 237, 245, 253, 255, 266, 278, 283, 282, 286, 288, 288, 268, 247, 237, 214, 209, 198, 193, 193, 175, 165, 147, 144, 152, 159, 160, 185, 210, 212, 219, 211, 203, 191, 193, 209, 211, 210, 230, 274, 350, 419, 473, 520, 569, 611, 646, 640, 644, 612, 601, 589, 581, 617, 628, 634, 671, 717, 794, 852, 969, 1057, 1131, 1200, 1194, 1184, 1124, 1032, 935, 831, 739, 644, 606, 601, 605, 584, 578, 579, 646, 687, 710, 710, 664, 611, 529, 410, 301, 210, 139, 122, 115, 101, 95, 83, 71, 72, 75, 82, 117, 146, 176, 200, 211, 209, 208, 215, 219, 214, 199, 190, 191, 197, 218, 232, 256, 271, 273, 291, 303, 333, 355, 350, 351, 349, 352, 349, 350, 354, 368, 365, 361, 361, 341, 306, 288, 287, 258, 251, 246, 245, 260, 259, 241, 223, 211, 197, 169, 133, 124, 105, 103, 103, 104, 109, 126, 161, 218, 295, 392, 483, 558, 639, 699, 766, 797, 809, 793, 798, 800, 782, 759, 751, 787, 835, 890, 928, 989, 1032, 1095, 1158, 1147, 1110, 1081, 1022, 980, 884, 790, 750, 718, 717, 695, 669, 659, 635, 578, 516, 443, 381, 322, 291, 255, 234, 216, 189, 166, 147, 121, 103, 90, 82, 74, 70, 77, 80, 90, 96, 91, 94, 106, 117, 131, 137, 155, 168, 189, 202, 204, 223, 227, 222, 216, 215, 209, 215, 222, 213, 215, 233, 253, 261, 267, 286, 291, 296, 305, 298, 283, 260, 255, 254, 219, 226, 201, 198, 174, 166, 154, 148, 152, 156, 153, 134, 125, 125, 124, 122, 141, 158, 187, 224, 257, 312, 357, 380, 434, 489, 549, 574, 591, 616, 621, 636, 668, 710, 748, 788, 824, 918, 974, 1025, 1046, 1064, 1095, 1090, 1086, 1052, 1030, 994, 941, 898, 838, 768, 721, 727, 714, 736, 729, 726, 700, 699, 643, 608, 550, 489, 405, 332, 276, 220, 177, 126, 127, 128, 115, 102, 107, 110, 134, 140, 151, 149, 165, 166, 169, 171, 173, 169, 149, 129, 127, 121, 129, 122, 140, 166, 168, 178, 177, 175, 215, 237, 263, 267, 279, 268, 282, 286, 291, 285, 298, 301, 311, 314, 343, 353, 348, 356, 350, 355, 336, 315, 300, 304, 303, 308, 278, 274, 251, 234, 224, 216, 204, 187, 179, 178, 192, 193, 210, 219, 243, 307, 355, 422, 484, 583, 646, 631, 646, 635, 612, 581, 537, 523, 524, 536, 558, 615, 666, 731, 788, 830, 885, 951, 977, 1010, 1018, 1029, 1019, 994, 955, 910, 835, 808, 771, 738, 733, 698, 701, 691, 685, 654, 641, 630, 615, 611, 600, 566, 546, 531, 538, 496, 435, 384, 311, 242, 178, 123, 94, 85, 93, 107, 121, 122, 116, 122, 132, 138, 149, 141, 158, 159, 170, 161, 169, 181, 195, 199, 214, 226, 233, 235, 250, 263, 269, 283, 279, 282, 281, 276, 279, 287, 280, 283, 281, 302, 303, 305, 281, 268, 261, 251, 229, 196, 170, 155, 140, 144, 148, 152, 157, 163, 162, 158, 139, 126, 123, 106, 114, 151, 206, 298, 393, 459, 548, 616, 677, 706, 678, 640, 625, 615, 610, 568, 550, 543, 535, 542, 566, 598, 647, 713, 796, 861, 918, 938, 937, 912, 873, 816, 762, 699, 652, 610, 580, 557, 532, 525, 506, 515, 512, 513, 499, 482, 460, 449, 431, 416, 408, 401, 402, 383, 365, 346, 333, 302, 287, 259, 239, 210, 188, 159, 153, 135, 138, 155, 155, 152, 157, 158, 174, 188, 198, 205, 213, 228, 222, 237, 241, 251, 266, 270, 269, 270, 247, 231, 219, 202, 180, 154, 156, 177, 195, 194, 202, 204, 207, 206, 191, 169, 158, 158, 150, 152, 161, 167, 168, 158, 164, 192, 233, 253, 291, 353, 425, 513, 568, 649, 678, 695, 686, 677, 645, 618, 586, 567, 551, 551, 549, 563, 618, 668, 722, 780, 840, 890, 913, 920, 889, 856, 802, 760, 722, 691, 647, 630, 586, 560, 540, 515, 487, 465, 458, 471, 479, 497, 499, 510, 509, 476, 465, 445, 443, 429, 393, 330, 288, 255, 215, 175, 139, 102, 98, 100, 104, 99, 90, 96, 105, 134, 139, 150, 158, 173, 177, 173, 171, 175, 197, 225, 237, 233, 231, 242, 252, 253, 243, 237, 225, 235, 241, 246, 238, 244, 247, 260, 266, 244, 242, 226, 197, 177, 171, 173, 168, 163, 169, 176, 180, 162, 149, 128, 119, 101, 92, 88, 89, 90, 93, 102, 109, 149, 175, 216, 289, 376, 446, 519, 577, 650, 693, 739, 742, 741, 741, 766, 811, 833, 844, 847, 873, 901, 942, 980, 991, 1029, 1036, 1036, 1017, 941, 896, 841, 796, 746, 713, 677, 635, 587, 550, 513, 456, 421, 360, 307, 265, 249, 234, 207, 184, 166, 158, 143, 133, 118, 121, 113, 100, 98, 104, 104, 113, 126, 137, 167, 173, 191, 198, 205, 204, 204, 209, 233, 223, 235, 251, 258, 281, 315, 335, 363, 364, 382, 400, 432, 448, 437, 416, 420, 406, 412, 392, 358, 339, 345, 349, 354, 336, 326, 327, 313, 292, 248, 214, 201, 188, 187, 194, 227, 247, 251, 260, 265, 288, 280, 298, 294, 268, 250, 264, 268, 283, 282, 325, 396, 458, 507, 562, 592, 611, 605, 613, 633, 648, 646, 662, 677, 700, 745, 792, 813, 821, 871, 894, 914, 915, 880, 880, 849, 801, 724, 692, 694, 701, 672, 664, 672, 645, 647, 642, 607, 579, 546, 515, 469, 418, 391, 353, 345, 330, 323, 313, 285, 261, 244, 223, 211, 210, 222, 231, 228, 210, 197, 205, 230, 218, 213, 227, 210, 217, 228, 223, 224, 221, 227, 239, 238, 240, 283, 303, 319, 328, 354, 378, 377, 371, 351, 314, 316, 281, 275, 293, 321, 311, 312, 334, 343, 312, 301, 305, 294, 296, 300, 304, 312, 310, 312, 297, 292, 296, 281, 269, 262, 240, 248, 266, 293, 332, 374, 376, 422, 457, 488, 526, 572, 599, 626, 630, 645, 649, 638, 681, 707, 719, 779, 820, 868, 872, 891, 884, 892, 871, 877, 900, 898, 906, 870, 824, 780, 736, 681, 619, 587, 561, 545, 509, 469, 444, 411, 380, 370, 340, 307, 305, 311, 320, 306, 303, 281, 248, 231, 202, 183, 178, 173, 161, 163, 216, 237, 252, 259, 274, 300, 307, 317, 317, 331, 336, 357, 357, 355, 355, 372, 358, 347, 335, 344, 345, 344, 362, 388, 403, 398, 385, 358, 357, 345, 330, 341, 347, 339, 356, 367, 340, 349, 369, 365, 393, 401, 424, 457, 467, 463, 456, 400, 387, 364, 355, 326, 322, 326, 334, 359, 388, 442, 498, 562, 594, 623, 647, 668, 667, 643, 599, 578, 584, 584, 578, 586, 631, 663, 720, 761, 803, 858, 918, 946, 958, 890, 835, 705, 681, 622, 601, 554, 523, 504, 473, 422, 376, 373, 364, 354, 339, 293, 275, 249, 270, 290, 289, 284, 262, 241, 211, 172, 148, 141, 135, 126, 133, 139, 155, 151, 152, 152, 154, 152, 148, 157, 158, 157, 158, 160, 175, 189, 220, 228, 238, 256, 286, 320, 347, 368, 388, 393, 408, 397, 371, 352, 350, 375, 366, 390, 400, 376, 358, 352, 344, 319, 313, 314, 329, 314, 289, 279, 288, 291, 293, 287, 287, 268, 251, 258, 252, 253, 230, 202, 222, 251, 283, 324, 413, 493, 555, 560, 620, 631, 645, 679, 696, 659, 657, 652, 656, 681, 688, 699, 705, 714, 767, 844, 888, 930, 931, 979, 978, 1004, 993, 966, 960, 950, 913, 870, 804, 736, 687, 610, 571, 560, 541, 494, 459, 452, 455, 422, 424, 472, 468, 456, 448, 447, 411, 385, 323, 252, 213, 158, 132, 129, 111, 93, 80, 74, 81, 78, 76, 82, 72, 98, 90, 85, 79, 75, 63, 70, 70, 55, 39, 50, 75, 90, 87, 96, 101, 105, 115, 87, 78, 93, 109, 121, 123, 122, 137, 140, 131, 146, 149, 157, 167, 169, 176, 158, 163, 183, 176, 150, 126, 114, 135, 114, 118, 105, 118, 137, 110, 118, 138, 130, 146, 151, 151, 175, 192, 159, 154, 165, 151, 139, 146, 180, 188, 188, 190, 193, 189, 196, 194, 181, 175, 172, 186, 177, 188, 202, 175, 173, 184, 187, 217, 205, 195, 180, 186, 192, 171, 167, 158, 151, 165, 184, 189, 183, 190, 174, 162, 167, 136, 139, 143, 139, 124, 127, 128, 109, 119, 119, 116, 145, 143, 123, 115, 125, 121, 122, 108, 123, 118, 100, 127, 133, 109, 122, 103, 113, 118, 116, 111, 106, 95, 105, 107, 125, 113, 124, 119, 118, 107, 89, 87, 101, 132, 102, 119, 119, 97, 108, 100, 129, 127, 106, 109, 115, 131, 134, 157, 176, 123, 108, 134, 116, 122, 109, 114, 125, 161, 104, 132, 123, 127, 133, 143, 164, 153, 133, 105, 95, 92, 114, 93, 90, 109, 98, 86, 88, 84, 70, 78, 94, 109, 73, 76, 92, 112, 114, 97, 110, 109, 133, 142, 121, 122, 130, 131, 100, 128, 107, 138, 161, 128, 134, 138, 152, 143, 134, 147, 182, 187, 170, 152, 178, 154, 122, 131, 115, 112, 110, 95, 91, 64, 50, 40, 32, 33, 43, 61, 57, 48, 48, 62, 71, 58, 50, 34, 40, 36, 26, 34, 38, 45, 40, 43, 48, 47, 40, 40, 27, 27, 26, 18, 24, 31, 27, 28, 20, 21, 24, 22, 30, 35, 25, 22, 29, 24, 26, 29, 37, 29, 17, 21, 28, 33, 25, 22, 36, 31, 33, 38, 35, 38, 36, 36, 44, 42, 43, 46, 45, 40, 35, 27, 30, 27, 26, 29, 29, 30, 31, 24, 23, 37, 35, 32, 20, 21, 25, 27, 39, 46, 36, 32, 33, 36, 44, 41, 34, 38, 41, 39, 40, 40, 41, 37, 37, 38, 46, 46, 40, 52, 58, 58, 55, 51, 49, 51, 57, 59, 45, 48, 54, 53, 41, 41, 38, 37, 35, 36, 32, 46, 47, 53, 47, 60, 72, 75, 71, 67, 63, 69, 70, 82, 72, 68, 71, 84, 89, 77, 71, 76, 71, 73, 73, 57, 61, 73, 81, 76, 72, 59, 65, 80, 61, 67, 58, 63, 53, 49, 54, 50, 50, 63, 77, 76, 76, 68, 73, 93, 83, 64, 59, 69, 75, 71, 75, 70, 69, 74, 84, 85, 86, 90, 75, 71, 57, 63, 62, 64, 59, 67, 78, 74, 68, 60, 59, 77, 96, 83, 90, 70, 56, 54, 61, 64, 51, 47, 47, 39, 31, 26, 23, 34, 38, 54, 47, 49, 43, 31, 31, 32, 44, 48, 65, 65, 50, 49, 40, 40, 40, 34, 40, 39, 49, 55, 41, 34, 36, 43, 42, 48, 55, 66, 48, 49, 48, 46, 39, 38, 35, 37, 31, 30, 31, 24, 25, 19, 13, 11, 13, 19, 16, 9, 8, 13, 20, 20, 20, 21, 18, 15, 18, 16, 14, 13, 9, 13, 21, 16, 17, 19, 11, 14, 19, 13, 13, 8, 5, 8, 7, 7, 11, 10, 6, 4, 5, 10, 11, 15, 14, 13, 12, 10, 15, 15, 16, 18, 17, 15, 13, 13, 14, 15, 13, 14, 15, 18, 20, 18, 17, 15, 13, 13, 9, 6, 4, 6, 9, 12, 10, 9, 7, 8, 8, 10, 13, 25, 43, 64, 68, 74, 81, 88, 86, 78, 79, 72, 64, 60, 64, 57, 60, 53, 51, 50, 50, 54, 58, 62, 62, 71, 79, 85, 80, 72, 63, 62, 60, 59, 51, 29, 19, 15, 24, 27, 29, 32, 33, 38, 45, 47, 47, 43, 50, 55, 67, 78, 80, 80, 62, 61, 71, 66, 58, 58, 62, 58, 58, 58, 59, 56, 58, 58, 60, 67, 72, 56, 54, 52, 45, 49, 50, 46, 48, 45, 38, 37, 34, 36, 35, 32, 28, 25, 19, 18, 17, 17, 16, 16, 15, 12, 9, 8, 6, 5, 7, 8, 6, 6, 7, 9, 8, 6, 5, 5, 7, 6, 8, 8, 5, 4, 6, 4, 1, 1, 0, 3, 4, 7, 6, 3, 3, 1, 0, 0, 0, 1, 4, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    maxtab, mintab = peakdet(series,delta=10, minimum_y_threshold=500)
    plt.plot(series)
    plt.scatter(array(maxtab)[:,0], array(maxtab)[:,1], color='blue')
    # plt.scatter(array(mintab)[:,0], array(mintab)[:,1], color='red')
    plt.show()
